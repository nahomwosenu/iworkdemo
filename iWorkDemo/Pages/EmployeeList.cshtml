@page
@model iWorkDemo.Pages.EmployeeListModel
@{
    <head><link href="https://fonts.googleapis.com/css?family=Mulish&display=swap" rel="stylesheet" /><link href="./css/main.css" rel="stylesheet" /><title>Document</title>
                                                                                                                                                                                                                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
                                                                                                                                                                                                                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="stylesheet">
                                                                                                                                                                                                                    <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
                                                                                                                                                                                                                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
                                                                                                                                                                                                                    <style>
                                                                                                                                                                                                                    img{
                                                                                                                                                                                                                      width: 48px;
                                                                                                                                                                                                                      margin: 5px;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    tr{
                                                                                                                                                                                                                    background-color: #fff;
                                                                                                                                                                                                                    align-content: center; 
                                                                                                                                                                                                                    align-items: center;
                                                                                                                                                                                                                    border-color: #FF6B00;
                                                                                                                                                                                                                    border-width: 2px;
                                                                                                                                                                                                                    border-radius: 5px;
                                                                                                                                                                                                                    border-style: solid;
                                                                                                                                                                                                                    border-collapse: separate;
                                                                                                                                                                                                                    margin-top: 10px;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    tbody{
                                                                                                                                                                                                                      border-collapse: separate;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    i{
                                                                                                                                                                                                                      color: #FF6B00;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    table{
                                                                                                                                                                                                                      border-spacing: 10px;
                                                                                                                                                                                                                      margin-top: 20px;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    </style>
    </head>
    <body style="background-color: #374151;">
                                                                                                                                                                                                                        <section >
                                                                                                                                                                                                                      <div class="container py-5">
                                                                                                                                                                                                                        <div class="row">
                                                                                                                                                                                                                                <div class="col-lg-12 text-white align-items-center justify-content-center">
                                                                                                                                                                                                                                  <h2 style="margin-left: 25%;">Employee's Detail</h2>
                                                                                                                                                                                                                                  <table class="table text-black" style="background-color: #D9D9D9;">
                                                                                                                                                                                                                                    <tbody id="body">
                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                    </tbody>
                                                                                                                                                                                                                                  </table>
                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                      </div>
                                                                                                                                                                                                                    </section>
                                                                                                                                                                                                                    <script>
                                                                                        const endpoint = "/v1/list";
                                                                                                                                                                                                                    const row = ({ firstName, lastName, email, gender, id }) => `
                                                                                                                                                                                                                    <tr id="${id}">
                                                                                                                                                                                                                                <td><img src="images/user.png" alt="avatar" width="48px"> ${firstName}</td>
                                                                                                                                                                                                                                <td>${lastName}</td>
                                                                                                                                                                                                                                <td>${email}</td>
                                                                                                                                                                                                                                <td>${gender}</td>
                                                                                                                                                                                                                                <td><a href='/employeeedit?id=${id}'><i id="${id}" class="fa-solid fa-pen"></i></a></td>
                                                                                                                                                                                                                                <td><i onclick="deleteEmployee(${id})" emp="${id}" class="fa-solid fa-trash-can"></i></td>
                                                                                                                                                                                                                              </tr>`;
                                                                                                                                                                                                                    function loadAllEmployees() {
                                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                                            type: "GET",
                                                                                                                                                                                                                            url: endpoint,
                                                                                                                                                                                                                            success: function(data) {
                                                                                                                                                                                                                                console.log(data);
                                                                                                                                                                                                                                if (data.status == "success") {
                                                                                                                                                                                                                                    let list = data.data;
                                                                                                                                                                                                                                    for (let i = 0; i < list.length; i++) {
                                                                                                                                                                                                                                        let emp = list[i];
                                                                                                                                                                                                                                        $("#body").append([
                                                                                                                                                                                                                                            {firstName: emp.firstName, lastName: emp.lastName, email: emp.email, gender: emp.gender, id: emp.id},
                                                                                                                                                                                                                                        ].map(row).join(''));
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                    alert(data.message);
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            },
                                                                                                                                                                                                                            error: (err) => {
                                                                                                                                                                                                                                alert(err.message);
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        })
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                    function deleteEmployee(id){
                                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                                            type: "GET",
                                                                                                                                                                                                                            url: "/v1/remove",
                                                                                                                                                                                                                            data: {
                                                                                                                                                                                                                                "id": id
                                                                                                                                                                                                                            },
                                                                                                                                                                                                                            success: function(resp) {
                                                                                                                                                                                                                                if (resp.status == "success") {
                                                                                                                                                                                                                                    $("#" + id).remove();
                                                                                                                                                                                                                                    alert('Record deleted successfully');
                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                    alert('Something went wrong!');
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            },
                                                                                                                                                                                                                            error: function(err) {
                                                                                                                                                                                                                                console.log(err);
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        });
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                $(document).ready(function() {
                                                                                                                                                                                                                    loadAllEmployees();
                                                                                                                                                                                                                    $("#delete").on("click", function() {
                                                                                                                                                                                                                        
                                                                                                                                                                                                                    });
                                                                                                                                                                                                                });
                                                                                                                                                                                                                
                                                                                                                                                                                                                    </script>
    </body>
}
